{"ast":null,"code":"var _jsxFileName = \"/home/jordan/projects/djangoreactshop-main/src/containers/Checkout.js\";\nimport React, { Component } from \"react\";\nimport { CardElement, injectStripe, Elements, StripeProvider } from \"react-stripe-elements\";\nimport { Button, Container, Dimmer, Divider, Form, Header, Image, Item, Label, Loader, Message, Segment, Select } from \"semantic-ui-react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { authAxios } from \"../utils\";\nimport { checkoutURL, orderSummaryURL, addCouponURL, addressListURL } from \"../constants\";\n\nconst OrderPreview = props => {\n  const {\n    data\n  } = props;\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 5\n    }\n  }, data && /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Item.Group, {\n    relaxed: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 11\n    }\n  }, data.order_items.map((orderItem, i) => {\n    return /*#__PURE__*/React.createElement(Item, {\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Item.Image, {\n      size: \"tiny\",\n      src: `http://127.0.0.1:8000${orderItem.item.image}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(Item.Content, {\n      verticalAlign: \"middle\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Item.Header, {\n      as: \"a\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 21\n      }\n    }, orderItem.quantity, \" x \", orderItem.item.title), /*#__PURE__*/React.createElement(Item.Extra, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 23\n      }\n    }, \"$\", orderItem.final_price))));\n  })), /*#__PURE__*/React.createElement(Item.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Item.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Item.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 17\n    }\n  }, \"Order Total: $\", data.total, data.coupon && /*#__PURE__*/React.createElement(Label, {\n    color: \"green\",\n    style: {\n      marginLeft: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 21\n    }\n  }, \"Current coupon: \", data.coupon.code, \" for $\", data.coupon.amount)))))));\n};\n\nclass CouponForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      code: \"\"\n    };\n\n    this.handleChange = e => {\n      this.setState({\n        code: e.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      const {\n        code\n      } = this.state;\n      this.props.handleAddCoupon(e, code);\n      this.setState({\n        code: \"\"\n      });\n    };\n  }\n\n  render() {\n    const {\n      code\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Form.Field, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }\n    }, \"Coupon code\"), /*#__PURE__*/React.createElement(\"input\", {\n      placeholder: \"Enter a coupon..\",\n      value: code,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(Button, {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }\n    }, \"Submit\")));\n  }\n\n}\n\nclass CheckoutForm extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: null,\n      loading: false,\n      error: null,\n      success: false,\n      shippingAddresses: [],\n      billingAddresses: [],\n      selectedBillingAddress: \"\",\n      selectedShippingAddress: \"\"\n    };\n\n    this.handleGetDefaultAddress = addresses => {\n      const filteredAddresses = addresses.filter(el => el.default === true);\n\n      if (filteredAddresses.length > 0) {\n        return filteredAddresses[0].id;\n      }\n\n      return \"\";\n    };\n\n    this.handleFetchBillingAddresses = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(addressListURL(\"B\")).then(res => {\n        this.setState({\n          billingAddresses: res.data.map(a => {\n            return {\n              key: a.id,\n              text: `${a.street_address}, ${a.apartment_address}, ${a.country}`,\n              value: a.id\n            };\n          }),\n          selectedBillingAddress: this.handleGetDefaultAddress(res.data),\n          loading: false\n        });\n      }).catch(err => {\n        this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    this.handleFetchShippingAddresses = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(addressListURL(\"S\")).then(res => {\n        this.setState({\n          shippingAddresses: res.data.map(a => {\n            return {\n              key: a.id,\n              text: `${a.street_address}, ${a.apartment_address}, ${a.country}`,\n              value: a.id\n            };\n          }),\n          selectedShippingAddress: this.handleGetDefaultAddress(res.data),\n          loading: false\n        });\n      }).catch(err => {\n        this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    this.handleFetchOrder = () => {\n      this.setState({\n        loading: true\n      });\n      authAxios.get(orderSummaryURL).then(res => {\n        this.setState({\n          data: res.data,\n          loading: false\n        });\n      }).catch(err => {\n        if (err.response.status === 404) {\n          this.props.history.push(\"/products\");\n        } else {\n          this.setState({\n            error: err,\n            loading: false\n          });\n        }\n      });\n    };\n\n    this.handleAddCoupon = (e, code) => {\n      e.preventDefault();\n      this.setState({\n        loading: true\n      });\n      authAxios.post(addCouponURL, {\n        code\n      }).then(res => {\n        this.setState({\n          loading: false\n        });\n        this.handleFetchOrder();\n      }).catch(err => {\n        this.setState({\n          error: err,\n          loading: false\n        });\n      });\n    };\n\n    this.handleSelectChange = (e, {\n      name,\n      value\n    }) => {\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.submit = ev => {\n      ev.preventDefault();\n      this.setState({\n        loading: true\n      });\n\n      if (this.props.stripe) {\n        this.props.stripe.createToken().then(result => {\n          if (result.error) {\n            this.setState({\n              error: result.error.message,\n              loading: false\n            });\n          } else {\n            this.setState({\n              error: null\n            });\n            const {\n              selectedBillingAddress,\n              selectedShippingAddress\n            } = this.state;\n            authAxios.post(checkoutURL, {\n              stripeToken: result.token.id,\n              selectedBillingAddress,\n              selectedShippingAddress\n            }).then(res => {\n              this.setState({\n                loading: false,\n                success: true\n              });\n            }).catch(err => {\n              this.setState({\n                loading: false,\n                error: err\n              });\n            });\n          }\n        });\n      } else {\n        console.log(\"Stripe is not loaded\");\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.handleFetchOrder();\n    this.handleFetchBillingAddresses();\n    this.handleFetchShippingAddresses();\n  }\n\n  render() {\n    const {\n      data,\n      error,\n      loading,\n      success,\n      billingAddresses,\n      shippingAddresses,\n      selectedBillingAddress,\n      selectedShippingAddress\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 7\n      }\n    }, error && /*#__PURE__*/React.createElement(Message, {\n      error: true,\n      header: \"There was some errors with your submission\",\n      content: JSON.stringify(error),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 11\n      }\n    }), loading && /*#__PURE__*/React.createElement(Segment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Dimmer, {\n      active: true,\n      inverted: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Loader, {\n      inverted: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 15\n      }\n    }, \"Loading\")), /*#__PURE__*/React.createElement(Image, {\n      src: \"/images/wireframe/short-paragraph.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(OrderPreview, {\n      data: data,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(CouponForm, {\n      handleAddCoupon: (e, code) => this.handleAddCoupon(e, code),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }\n    }, \"Select a billing address\"), billingAddresses.length > 0 ? /*#__PURE__*/React.createElement(Select, {\n      name: \"selectedBillingAddress\",\n      value: selectedBillingAddress,\n      clearable: true,\n      options: billingAddresses,\n      selection: true,\n      onChange: this.handleSelectChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 11\n      }\n    }) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 11\n      }\n    }, \"You need to \", /*#__PURE__*/React.createElement(Link, {\n      to: \"/profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 25\n      }\n    }, \"add a billing address\")), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }\n    }, \"Select a shipping address\"), shippingAddresses.length > 0 ? /*#__PURE__*/React.createElement(Select, {\n      name: \"selectedShippingAddress\",\n      value: selectedShippingAddress,\n      clearable: true,\n      options: shippingAddresses,\n      selection: true,\n      onChange: this.handleSelectChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 11\n      }\n    }) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 11\n      }\n    }, \"You need to \", /*#__PURE__*/React.createElement(Link, {\n      to: \"/profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 25\n      }\n    }, \"add a shipping address\")), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }\n    }), billingAddresses.length < 1 || shippingAddresses.length < 1 ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 11\n      }\n    }, \"You need to add addresses before you can complete your purchase\") : /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 13\n      }\n    }, \"Would you like to complete the purchase?\"), /*#__PURE__*/React.createElement(CardElement, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 13\n      }\n    }), success && /*#__PURE__*/React.createElement(Message, {\n      positive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Message.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 17\n      }\n    }, \"Your payment was successful\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 17\n      }\n    }, \"Go to your \", /*#__PURE__*/React.createElement(\"b\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 30\n      }\n    }, \"profile\"), \" to see the order delivery status.\")), /*#__PURE__*/React.createElement(Button, {\n      loading: loading,\n      disabled: loading,\n      primary: true,\n      onClick: this.submit,\n      style: {\n        marginTop: \"10px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 13\n      }\n    }, \"Submit\")));\n  }\n\n}\n\nconst InjectedForm = withRouter(injectStripe(CheckoutForm));\n\nconst WrappedForm = () => /*#__PURE__*/React.createElement(Container, {\n  text: true,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 354,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(StripeProvider, {\n  apiKey: \"\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 355,\n    columnNumber: 5\n  }\n}, /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 356,\n    columnNumber: 7\n  }\n}, /*#__PURE__*/React.createElement(\"h1\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 357,\n    columnNumber: 9\n  }\n}, \"Complete your order\"), /*#__PURE__*/React.createElement(Elements, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 358,\n    columnNumber: 9\n  }\n}, /*#__PURE__*/React.createElement(InjectedForm, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 359,\n    columnNumber: 11\n  }\n})))));\n\nexport default WrappedForm;","map":{"version":3,"sources":["/home/jordan/projects/djangoreactshop-main/src/containers/Checkout.js"],"names":["React","Component","CardElement","injectStripe","Elements","StripeProvider","Button","Container","Dimmer","Divider","Form","Header","Image","Item","Label","Loader","Message","Segment","Select","Link","withRouter","authAxios","checkoutURL","orderSummaryURL","addCouponURL","addressListURL","OrderPreview","props","data","order_items","map","orderItem","i","item","image","quantity","title","final_price","total","coupon","marginLeft","code","amount","CouponForm","state","handleChange","e","setState","target","value","handleSubmit","handleAddCoupon","render","CheckoutForm","loading","error","success","shippingAddresses","billingAddresses","selectedBillingAddress","selectedShippingAddress","handleGetDefaultAddress","addresses","filteredAddresses","filter","el","default","length","id","handleFetchBillingAddresses","get","then","res","a","key","text","street_address","apartment_address","country","catch","err","handleFetchShippingAddresses","handleFetchOrder","response","status","history","push","preventDefault","post","handleSelectChange","name","submit","ev","stripe","createToken","result","message","stripeToken","token","console","log","componentDidMount","JSON","stringify","marginTop","InjectedForm","WrappedForm"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  CardElement,\n  injectStripe,\n  Elements,\n  StripeProvider\n} from \"react-stripe-elements\";\nimport {\n  Button,\n  Container,\n  Dimmer,\n  Divider,\n  Form,\n  Header,\n  Image,\n  Item,\n  Label,\n  Loader,\n  Message,\n  Segment,\n  Select\n} from \"semantic-ui-react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport { authAxios } from \"../utils\";\nimport {\n  checkoutURL,\n  orderSummaryURL,\n  addCouponURL,\n  addressListURL\n} from \"../constants\";\n\nconst OrderPreview = props => {\n  const { data } = props;\n  return (\n    <React.Fragment>\n      {data && (\n        <React.Fragment>\n          <Item.Group relaxed>\n            {data.order_items.map((orderItem, i) => {\n              return (\n                <Item key={i}>\n                  <Item.Image\n                    size=\"tiny\"\n                    src={`http://127.0.0.1:8000${orderItem.item.image}`}\n                  />\n                  <Item.Content verticalAlign=\"middle\">\n                    <Item.Header as=\"a\">\n                      {orderItem.quantity} x {orderItem.item.title}\n                    </Item.Header>\n                    <Item.Extra>\n                      <Label>${orderItem.final_price}</Label>\n                    </Item.Extra>\n                  </Item.Content>\n                </Item>\n              );\n            })}\n          </Item.Group>\n\n          <Item.Group>\n            <Item>\n              <Item.Content>\n                <Item.Header>\n                  Order Total: ${data.total}\n                  {data.coupon && (\n                    <Label color=\"green\" style={{ marginLeft: \"10px\" }}>\n                      Current coupon: {data.coupon.code} for $\n                      {data.coupon.amount}\n                    </Label>\n                  )}\n                </Item.Header>\n              </Item.Content>\n            </Item>\n          </Item.Group>\n        </React.Fragment>\n      )}\n    </React.Fragment>\n  );\n};\n\nclass CouponForm extends Component {\n  state = {\n    code: \"\"\n  };\n\n  handleChange = e => {\n    this.setState({\n      code: e.target.value\n    });\n  };\n\n  handleSubmit = e => {\n    const { code } = this.state;\n    this.props.handleAddCoupon(e, code);\n    this.setState({ code: \"\" });\n  };\n\n  render() {\n    const { code } = this.state;\n    return (\n      <React.Fragment>\n        <Form onSubmit={this.handleSubmit}>\n          <Form.Field>\n            <label>Coupon code</label>\n            <input\n              placeholder=\"Enter a coupon..\"\n              value={code}\n              onChange={this.handleChange}\n            />\n          </Form.Field>\n          <Button type=\"submit\">Submit</Button>\n        </Form>\n      </React.Fragment>\n    );\n  }\n}\n\nclass CheckoutForm extends Component {\n  state = {\n    data: null,\n    loading: false,\n    error: null,\n    success: false,\n    shippingAddresses: [],\n    billingAddresses: [],\n    selectedBillingAddress: \"\",\n    selectedShippingAddress: \"\"\n  };\n\n  componentDidMount() {\n    this.handleFetchOrder();\n    this.handleFetchBillingAddresses();\n    this.handleFetchShippingAddresses();\n  }\n\n  handleGetDefaultAddress = addresses => {\n    const filteredAddresses = addresses.filter(el => el.default === true);\n    if (filteredAddresses.length > 0) {\n      return filteredAddresses[0].id;\n    }\n    return \"\";\n  };\n\n  handleFetchBillingAddresses = () => {\n    this.setState({ loading: true });\n    authAxios\n      .get(addressListURL(\"B\"))\n      .then(res => {\n        this.setState({\n          billingAddresses: res.data.map(a => {\n            return {\n              key: a.id,\n              text: `${a.street_address}, ${a.apartment_address}, ${a.country}`,\n              value: a.id\n            };\n          }),\n          selectedBillingAddress: this.handleGetDefaultAddress(res.data),\n          loading: false\n        });\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  handleFetchShippingAddresses = () => {\n    this.setState({ loading: true });\n    authAxios\n      .get(addressListURL(\"S\"))\n      .then(res => {\n        this.setState({\n          shippingAddresses: res.data.map(a => {\n            return {\n              key: a.id,\n              text: `${a.street_address}, ${a.apartment_address}, ${a.country}`,\n              value: a.id\n            };\n          }),\n          selectedShippingAddress: this.handleGetDefaultAddress(res.data),\n          loading: false\n        });\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  handleFetchOrder = () => {\n    this.setState({ loading: true });\n    authAxios\n      .get(orderSummaryURL)\n      .then(res => {\n        this.setState({ data: res.data, loading: false });\n      })\n      .catch(err => {\n        if (err.response.status === 404) {\n          this.props.history.push(\"/products\");\n        } else {\n          this.setState({ error: err, loading: false });\n        }\n      });\n  };\n\n  handleAddCoupon = (e, code) => {\n    e.preventDefault();\n    this.setState({ loading: true });\n    authAxios\n      .post(addCouponURL, { code })\n      .then(res => {\n        this.setState({ loading: false });\n        this.handleFetchOrder();\n      })\n      .catch(err => {\n        this.setState({ error: err, loading: false });\n      });\n  };\n\n  handleSelectChange = (e, { name, value }) => {\n    this.setState({ [name]: value });\n  };\n\n  submit = ev => {\n    ev.preventDefault();\n    this.setState({ loading: true });\n    if (this.props.stripe) {\n      this.props.stripe.createToken().then(result => {\n        if (result.error) {\n          this.setState({ error: result.error.message, loading: false });\n        } else {\n          this.setState({ error: null });\n          const {\n            selectedBillingAddress,\n            selectedShippingAddress\n          } = this.state;\n          authAxios\n            .post(checkoutURL, {\n              stripeToken: result.token.id,\n              selectedBillingAddress,\n              selectedShippingAddress\n            })\n            .then(res => {\n              this.setState({ loading: false, success: true });\n            })\n            .catch(err => {\n              this.setState({ loading: false, error: err });\n            });\n        }\n      });\n    } else {\n      console.log(\"Stripe is not loaded\");\n    }\n  };\n\n  render() {\n    const {\n      data,\n      error,\n      loading,\n      success,\n      billingAddresses,\n      shippingAddresses,\n      selectedBillingAddress,\n      selectedShippingAddress\n    } = this.state;\n\n    return (\n      <div>\n        {error && (\n          <Message\n            error\n            header=\"There was some errors with your submission\"\n            content={JSON.stringify(error)}\n          />\n        )}\n        {loading && (\n          <Segment>\n            <Dimmer active inverted>\n              <Loader inverted>Loading</Loader>\n            </Dimmer>\n            <Image src=\"/images/wireframe/short-paragraph.png\" />\n          </Segment>\n        )}\n\n        <OrderPreview data={data} />\n        <Divider />\n        <CouponForm\n          handleAddCoupon={(e, code) => this.handleAddCoupon(e, code)}\n        />\n        <Divider />\n        <Header>Select a billing address</Header>\n        {billingAddresses.length > 0 ? (\n          <Select\n            name=\"selectedBillingAddress\"\n            value={selectedBillingAddress}\n            clearable\n            options={billingAddresses}\n            selection\n            onChange={this.handleSelectChange}\n          />\n        ) : (\n          <p>\n            You need to <Link to=\"/profile\">add a billing address</Link>\n          </p>\n        )}\n        <Header>Select a shipping address</Header>\n        {shippingAddresses.length > 0 ? (\n          <Select\n            name=\"selectedShippingAddress\"\n            value={selectedShippingAddress}\n            clearable\n            options={shippingAddresses}\n            selection\n            onChange={this.handleSelectChange}\n          />\n        ) : (\n          <p>\n            You need to <Link to=\"/profile\">add a shipping address</Link>\n          </p>\n        )}\n        <Divider />\n\n        {billingAddresses.length < 1 || shippingAddresses.length < 1 ? (\n          <p>You need to add addresses before you can complete your purchase</p>\n        ) : (\n          <React.Fragment>\n            <Header>Would you like to complete the purchase?</Header>\n            <CardElement />\n            {success && (\n              <Message positive>\n                <Message.Header>Your payment was successful</Message.Header>\n                <p>\n                  Go to your <b>profile</b> to see the order delivery status.\n                </p>\n              </Message>\n            )}\n            <Button\n              loading={loading}\n              disabled={loading}\n              primary\n              onClick={this.submit}\n              style={{ marginTop: \"10px\" }}\n            >\n              Submit\n            </Button>\n          </React.Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nconst InjectedForm = withRouter(injectStripe(CheckoutForm));\n\nconst WrappedForm = () => (\n  <Container text>\n    <StripeProvider apiKey=\"\">\n      <div>\n        <h1>Complete your order</h1>\n        <Elements>\n          <InjectedForm />\n        </Elements>\n      </div>\n    </StripeProvider>\n  </Container>\n);\n\nexport default WrappedForm;\n"]},"metadata":{},"sourceType":"module"}